-- MOB FPS Unlocker UI with font presets, validation, and draggable frame

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local plr = Players.LocalPlayer
local playerGui = plr:WaitForChild("PlayerGui")

-- Clear old UI if exists
if playerGui:FindFirstChild("MobFPSUnlockerUI") then
    playerGui.MobFPSUnlockerUI:Destroy()
end

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "MobFPSUnlockerUI"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Draggable Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 320, 0, 270)
frame.Position = UDim2.new(0.5, -160, 0.4, -135)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0
frame.AnchorPoint = Vector2.new(0.5, 0.5)
frame.Parent = screenGui

-- Drag functionality
local dragging, dragInput, dragStart, startPos
local function update(input)
    local delta = input.Position - dragStart
    frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
        startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or
       input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or
       input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1, 0, 0, 32)
titleBar.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
titleBar.Parent = frame

local titleLabel = Instance.new("TextLabel")
titleLabel.Text = "ðŸ”¥ MOB FPS Unlocker"
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 18
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.BackgroundTransparency = 1
titleLabel.Size = UDim2.new(1, -60, 1, 0)
titleLabel.Position = UDim2.new(0, 10, 0, 0)
titleLabel.TextXAlignment = Enum.TextXAlignment.Left
titleLabel.Parent = titleBar

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Text = "âœ•"
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 20
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.BackgroundTransparency = 1
closeButton.Size = UDim2.new(0, 32, 1, 0)
closeButton.Position = UDim2.new(1, -36, 0, 0)
closeButton.Parent = titleBar
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Flag Input
local flagBox = Instance.new("TextBox")
flagBox.PlaceholderText = "Flag Name (e.g. FIntTaskSchedulerTargetFps)"
flagBox.Font = Enum.Font.Gotham
flagBox.TextSize = 16
flagBox.TextColor3 = Color3.new(1, 1, 1)
flagBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
flagBox.BorderSizePixel = 0
flagBox.Size = UDim2.new(1, -20, 0, 38)
flagBox.Position = UDim2.new(0, 10, 0, 48)
flagBox.ClearTextOnFocus = false
flagBox.Parent = frame

-- Value Input
local valueBox = Instance.new("TextBox")
valueBox.PlaceholderText = "Value (e.g. 240, true)"
valueBox.Font = Enum.Font.Gotham
valueBox.TextSize = 16
valueBox.TextColor3 = Color3.new(1, 1, 1)
valueBox.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
valueBox.BorderSizePixel = 0
valueBox.Size = UDim2.new(1, -20, 0, 38)
valueBox.Position = UDim2.new(0, 10, 0, 96)
valueBox.ClearTextOnFocus = false
valueBox.Parent = frame

-- Fonts dropdown label
local fontLabel = Instance.new("TextLabel")
fontLabel.Text = "Choose Font:"
fontLabel.Font = Enum.Font.Gotham
fontLabel.TextSize = 14
fontLabel.TextColor3 = Color3.new(1,1,1)
fontLabel.BackgroundTransparency = 1
fontLabel.Size = UDim2.new(0, 100, 0, 25)
fontLabel.Position = UDim2.new(0, 10, 0, 144)
fontLabel.TextXAlignment = Enum.TextXAlignment.Left
fontLabel.Parent = frame

-- Fonts dropdown (simple TextButton + TextLabel)
local fonts = {
    ["Gotham"] = Enum.Font.Gotham,
    ["GothamBold"] = Enum.Font.GothamBold,
    ["SourceSans"] = Enum.Font.SourceSans,
    ["SourceSansBold"] = Enum.Font.SourceSansBold,
    ["Arcade"] = Enum.Font.Arcade,
    ["Highway"] = Enum.Font.Highway,
}

local currentFontName = "Gotham"
local dropdownOpen = false

local dropdownButton = Instance.new("TextButton")
dropdownButton.Text = currentFontName
dropdownButton.Font = Enum.Font.Gotham
dropdownButton.TextSize = 14
dropdownButton.TextColor3 = Color3.new(1,1,1)
dropdownButton.BackgroundColor3 = Color3.fromRGB(40,40,40)
dropdownButton.BorderSizePixel = 0
dropdownButton.Size = UDim2.new(0, 130, 0, 25)
dropdownButton.Position = UDim2.new(0, 110, 0, 144)
dropdownButton.Parent = frame

local dropdownList = Instance.new("Frame")
dropdownList.BackgroundColor3 = Color3.fromRGB(30,30,30)
dropdownList.BorderSizePixel = 0
dropdownList.Position = UDim2.new(0, 110, 0, 169)
dropdownList.Size = UDim2.new(0, 130, 0, 0) -- start hidden
dropdownList.ClipsDescendants = true
dropdownList.Parent = frame

-- Add font options to dropdownList
local function closeDropdown()
    dropdownOpen = false
    dropdownList:TweenSize(UDim2.new(0, 130, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
end

local function openDropdown()
    dropdownOpen = true
    dropdownList:TweenSize(UDim2.new(0, 130, 0, #fonts * 25), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
end

dropdownButton.MouseButton1Click:Connect(function()
    if dropdownOpen then
        closeDropdown()
    else
        openDropdown()
    end
end)

local yOffset = 0
for fontName, fontEnum in pairs(fonts) do
    local option = Instance.new("TextButton")
    option.Text = fontName
    option.Font = fontEnum
    option.TextSize = 14
    option.TextColor3 = Color3.new(1,1,1)
    option.BackgroundColor3 = Color3.fromRGB(40,40,40)
    option.BorderSizePixel = 0
    option.Size = UDim2.new(1, 0, 0, 25)
    option.Position = UDim2.new(0, 0, 0, yOffset)
    option.Parent = dropdownList

    option.MouseButton1Click:Connect(function()
        currentFontName = fontName
        dropdownButton.Text = fontName
        closeDropdown()

        -- Update fonts on inputs and button
        flagBox.Font = fontEnum
        valueBox.Font = fontEnum
        applyBtn.Font = fontEnum
        titleLabel.Font = fontEnum
    end)

    yOffset = yOffset + 25
end

-- Apply Button
local applyBtn = Instance.new("TextButton")
applyBtn.Text = "Apply Flag"
applyBtn.Font = Enum.Font.GothamBold
applyBtn.TextSize = 18
applyBtn.TextColor3 = Color3.new(1, 1, 1)
applyBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 100)
applyBtn.BorderSizePixel = 0
applyBtn.Size = UDim2.new(1, -20, 0, 48)
applyBtn.Position = UDim2.new(0, 10, 0, 200)
applyBtn.Parent = frame

-- Popup function
local function CreatePopup(msg, success)
    local popup = Instance.new("TextLabel")
    popup.BackgroundColor3 = success and Color3.fromRGB(0, 170, 100) or Color3.fromRGB(180, 40, 40)
    popup.TextColor3 = Color3.new(1,1,1)
    popup.Text = msg
    popup.Font = Enum.Font.GothamBold
    popup.TextSize = 18
    popup.Size = UDim2.new(0, 260, 0, 40)
    popup.Position = UDim2.new(0.5, -130, 0.1, 0)
    popup.AnchorPoint = Vector2.new(0.5, 0)
    popup.BackgroundTransparency = 0.85
    popup.Parent = screenGui
    popup.ZIndex = 10

    delay(3, function()
        popup:Destroy()
    end)
end

-- Apply button logic with validation
applyBtn.MouseButton1Click:Connect(function()
    local flag = flagBox.Text:match("^%s*(.-)%s*$")
    local val = valueBox.Text:match("^%s*(.-)%s*$")

    if flag == "" or not flag:match("^[%a%d_]+$") then
        CreatePopup("Invalid Flag Name!", false)
        return
    end

    if val == "" then
        CreatePopup("Value cannot be empty!", false)
        return
    end

    if tonumber(val) then
        val = tonumber(val)
    elseif val:lower() == "true" then
        val = true
    elseif val:lower() == "false" then
        val = false
    end

    _G[flag] = val
    print("Set flag:", flag, val)
    CreatePopup("Flag Applied!", true)
end)
